# 安全警报：以太坊君士坦丁堡延期
2019 年 1 月 15 日， ChainSecurity 已向以太坊核心开发人员和以太坊安全社区通报了与君士坦丁堡相关的潜在问题。我们正在调查任何潜在的漏洞，并将在此博客文章和社交媒体渠道中进行更新。

出于谨慎考虑，以太坊社区的主要利益相关者已经确定，最好的行动方案是推迟计划中的君士坦丁堡分叉，该分叉原定于 2019 年 1 月 16 日在 7,080,000 区块发生。

这将要求任何运行节点的人（节点运营商、交易所、矿工、钱包服务等）在区块 7,080,000 之前更新到新版本的 Geth 或 Parity。7,080,000 块将在发布后大约 32 小时内或大约在太平洋时间 1 月 16 日晚上 8:00/东部时间 1 月 16 日晚上 11:00/格林威治标准时间 1 月 17 日凌晨 4:00 发生。

## 你需要做什么
如果你是一个简单与以太坊交互的人（你不运行节点），你不需要做任何事情。
### 矿工、交易所、节点运营商：
- 在发布时更新您的 Geth 和/或 Parity 实例。
- 这些版本尚未发布。我们将在可用时更新此帖子。
- 可用时，将在此处提供链接、版本号和说明。
- 我们希望在此博客发布后的 3-4 小时内发布更新版本。

#### Geth
- 升级到 1.8.21，或者
- 降级到 Geth 1.8.19或
- 保留在 1.8.20，但使用开关 `--override.constantinople=9999999` 无限期推迟君士坦丁堡分叉。

### Parity
- 升级到 Parity Ethereum 2.2.7-stable（推荐）
- 升级到 Parity Ethereum 2.3.0-beta
- 降级到 Parity Ethereum 2.2.4-beta（不推荐）

## 其他所有人：
Ledger、Trezor、Safe-T、Parity Signer、WallEth、Paper Wallets、MyCrypto、MyEtherWallet 和其他不通过同步和运行节点参与网络的用户或代币持有者。

- 你不必做任何事情。
合约所有者

- 你不必做任何事情。
- 您可以选择检查潜在漏洞的分析并检查您的合同。
- 但是，您无需执行任何操作，因为不会启用会引入此潜在漏洞的更改。

## 背景
ChainSecurity 的文章深入探讨了潜在的漏洞以及如何检查智能合约的漏洞。非常简短：

- EIP-1283 为 SSTORE 操作引入了更便宜的 gas 成本
- 一些智能合约（已经在链上）可能会使用代码模式，这会使它们在君士坦丁堡升级后容易受到重入攻击
- 在君士坦丁堡升级之前，这些智能合约不会受到攻击

增加易受攻击概率的合约是使用 `transfer()` 或 `send()` 函数，然后执行状态更改操作的合约。这种合约的一个例子是两方共同接收资金，决定如何分割所述资金，并开始支付这些资金。

## 推迟君士坦丁堡分叉的决定是如何做出的
ChainSecurity 和 TrailOfBits 等安全研究人员在整个区块链上运行（并且仍在运行）分析。他们在野外没有发现任何这种漏洞的案例。但是，仍然存在一些合同可能受到影响的非零风险。

由于风险不为零，并且确定风险所需的时间比计划中的君士坦丁堡升级之前的可用时间更长，因此出于谨慎考虑，决定推迟分叉。

参与讨论的各方包括但不限于：

- 安全研究人员
- 以太坊利益相关者
- 以太坊客户端开发者
- 智能合约所有者/开发者
- 钱包提供商
- 节点运营商
- Dapp 开发者
- 媒体

## 响应时间
- 太平洋时间上午 3:09

	ChainSecurity 通过以太坊基金会的漏洞赏金计划负责任地披露潜在漏洞
- 太平洋时间上午 8:09

	以太坊基金会要求 ChainSecurity 公开披露
- 太平洋时间上午 8 点 11 分

	ChainSecurity 原创文章发表
- 太平洋时间上午 8 点 52 分

	Martin Holst Swende 在 ethsecurity 和 AllCoreDevs Gitter 频道中发帖：“请阅读：https://medium.com/chainsecurity/constantinople-enables-new-reentrancy-attack-ace4088297d9 @/all 我们需要快速决定潜在后果以及如何应对前进。距离分叉发生还有大约 37 小时”
- 太平洋时间上午 8:52 - 太平洋时间上午 10:15

	跨渠道讨论潜在风险、链上分析以及需要采取的步骤
- 太平洋时间上午 10:15 - 太平洋时间下午 12:40

	通过 Zoom 音频电话与主要利益相关者进行讨论。gitter 和其他渠道的讨论也在继续
- 太平洋时间下午 12:08

	决定推迟君士坦丁堡升级
- 太平洋时间下午 1:30

	通过各种渠道和社交媒体发布的公共博客文章
	
本文由 EvanVanNess、Infura、MyCrypto、Parity、Status、The Ethereum Foundation 和 Ethereum Cat Herders 共同协作完成。